- name: Create /etc/im dir
  file: path=/etc/im state=directory

- name: Create /var/log/im dir
  file: path=/var/log/im state=directory

- name: Install dependencies for docker management
  pip: name=docker-py

- name: Launch im container
  docker_container:
    name: im
    image: "grycap/im:{{im_version}}"
    state: started
    restart: yes
    ports:
    - "8800:8800"
    - "8899:8899"
    exposed_ports:
    - 8899
    - 8800
    volumes:
    - "/etc/im:/etc/im"
    - "/var/log/im:/var/log/im"